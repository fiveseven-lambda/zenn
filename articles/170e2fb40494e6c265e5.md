---
title: "Twitter API ã‚’ä½¿ã£ã¦ Rust ã‹ã‚‰ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹"
emoji: "ğŸ¦"
type: "tech"
topics: ["rust", "twitter", "oauth"]
published: false
---
# ã“ã‚Œã¯ä½•
Twitter API ã‚’ä½¿ç”¨ã—ã¦ãƒ„ã‚¤ãƒ¼ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ï¼Œ Rust ã§æ›¸ãè¨˜äº‹ã§ã™ï¼[å…¬å¼ã®è§£èª¬](https://developer.twitter.com/en/docs)ã¨[ã“ã®è¨˜äº‹](https://qiita.com/hppRC/items/05a81b56d12d663d03e0)ã‚’å‚è€ƒã«ã—ãªãŒã‚‰æ›¸ã„ã¦ã„ã¾ã™ï¼
# Crates
ä½¿ç”¨ã‚¯ãƒ¬ãƒ¼ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š
| crate | version | features |
| - | - | - |
| base64 | 0.13.0 | |
| chrono | 0.4.19 | |
| hmac-sha1 | 0.1.3 | |
| percent-encoding | 2.1.0 |
| rand | 0.7.3 | |
| reqwest | 0.10.8 | |
| tokio | 0.2.22 | macros |
reqwest 0.10.8 ãŒ tokio 0.3.0 ä»¥é™ã§æ­£å¸¸ã«å‹•ã‹ãªã„ãŸã‚ï¼Œ tokio 0.2.22 ä»¥å‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ä¸‹ã•ã„ï¼ tokio ä»¥å¤–ã¯å…¨ã¦è¨˜äº‹åŸ·ç­†æ™‚ç‚¹ (2020/10/27) ã§æœ€æ–°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ï¼
# OAuth
Twitter ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ OAuth 1.0 ã«ã¤ã„ã¦ã®èª¬æ˜ã§ã™ï¼
## Keys & Tokens
[ã“ã“](https://developer.twitter.com/apps)ã®å³ä¸Šã«ã‚ã‚‹ Create an app ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ app ã‚’ä½œã‚Šï¼Œ Details ãƒœã‚¿ãƒ³ã‹ã‚‰ Keys and tokens ã‚¿ãƒ–ã‚’é–‹ã„ã¦ API key / API secret key / access token / access token secret ã® 4 ã¤ã‚’æ‰‹ã«å…¥ã‚Œã¾ã™ï¼ã“ã‚Œã¯æ‰‹å…ƒã®é©å½“ãªãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¦ãŠãï¼Œå¾Œã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰èª­ã¿å–ã‚Šã¾ã™ï¼
## signature
API secret key ã¨ access token secret ã¯ï¼Œ signature ã®ç”Ÿæˆã«ä½¿ã‚ã‚Œã¾ã™ï¼ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹éš›ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ signature base string ã¨ã„ã†æ–‡å­—åˆ—ã‚’æ§‹æˆã—ï¼Œã“ã‚Œã¨ API secret key / access token secret ã‹ã‚‰ signature ã‚’ç”Ÿæˆã—ã¾ã™ï¼ã‚µãƒ¼ãƒãƒ¼å´ã§ã“ã® signature ãŒç¢ºèªã•ã‚Œï¼Œèªå¯ãŒè¡Œã‚ã‚Œã¾ã™ï¼

signature base string ï¼Œ API secret key ï¼Œ access token secret ã‹ã‚‰ signature ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã¯æ¬¡ã®é€šã‚Šã§ã™ï¼š
1. API secret key ã¨ access token secret ã‚’ `&` ã§ç¹‹ã„ã æ–‡å­—åˆ—ã‚’ signing key ã¨ã™ã‚‹ï¼
2. signing key ã‚’éµã¨ã—ã¦ï¼Œ signature base string ã‚’ HMAC-SHA1 ã§ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ï¼
3. base64 ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ï¼
## signature base string
ä¸Šã§ç™»å ´ã—ãŸ signature base string ã¯ï¼Œæ¬¡ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ä½œã‚‰ã‚Œã¾ã™ï¼
- HTTP method (ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ã¨ãã¯ `POST`)
- URL (ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ã¨ãã¯ `https://api.twitter.com/1.1/statuses/update.json`)
- ãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  - `status`: ãƒ„ã‚¤ãƒ¼ãƒˆæœ¬æ–‡ï¼
  - `in_reply_to_status_id`: è¿”ä¿¡å…ˆãƒ„ã‚¤ãƒ¼ãƒˆã® ID ï¼
  
  ãªã©ï¼ˆä»–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰](https://developer.twitter.com/en/docs/twitter-api/v1/tweets/post-and-engage/api-reference/post-statuses-update)ï¼‰
- ãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  - `oauth_consumer_key`: API key
  - `oauth_token`: access token
  - `oauth_signature method`: twitter ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã¯ `HMAC-SHA1`ï¼
  - `oauth_version`: twitter ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ OAuth ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ `1.0`ï¼
  - `oauth_timestamp`: ç¾åœ¨æ™‚åˆ»ï¼ã“ã‚ŒãŒã‚ºãƒ¬ã¦ã„ã‚‹ã¨èªå¯ãŒä¸‹ã‚Šãªã„ã“ã¨ãŒã‚ã‚‹ï¼
  - `oauth_nonce`: ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼

ãŸã ã— HTTP method ã¨ URL ä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€Œã‚­ãƒ¼: å€¤ã®èª¬æ˜ã€ã®é †ã«æ›¸ã„ã¦ã„ã¾ã™ï¼

ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã« signature base string ã‚’ä½œã‚Šï¼Œãã“ã‹ã‚‰ signature ã‚’ç”Ÿæˆã—ã¾ã™ï¼åŒæ™‚ã«ï¼Œã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è‡ªä½“ã‚‚ HTTP ã«ä¹—ã›ã¦é€ã‚Šã¾ã™ï¼ãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ï¼Œ URL ã®æœ«å°¾ã«ä»˜ã‘åŠ ãˆã¾ã™ï¼ãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ï¼Œ signature ã¨ä¸€ç·’ã« HTTP ã® Authorization ãƒ˜ãƒƒãƒ€ã«ä¹—ã›ã¾ã™ï¼

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ signature base string ã‚’ä½œã‚‹æ–¹æ³•ã¯æ¬¡ã®é€šã‚Šã§ã™ï¼š
1. method ã¨ URL ä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¤ã„ã¦ï¼Œã‚­ãƒ¼ã¨å€¤ã®ä¸¡æ–¹ã‚’ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ï¼
2. ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸã‚­ãƒ¼ã«ã‚ˆã£ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¾æ›¸é †ã«ä¸¦ã¹ï¼Œã€Œã‚­ãƒ¼`=`å€¤ã€ã®å½¢å¼ã§æ›¸ã„ã¦ `&` ã§ã¤ãªã„ã ã‚‚ã®ã‚’ parameter string ã¨ã™ã‚‹ï¼
3. method ï¼Œ URL ã‚’ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸã‚‚ã®ï¼Œ parameter string ã‚’ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸã‚‚ã®ã® 3 ã¤ã‚’ï¼Œã“ã‚Œã‚‰ã®é †ã«ä¸¦ã¹ã¦ `&` ã§ã¤ãªãï¼

# è¨­è¨ˆ
`struct Client` ã« API key / API secret key / access token / access token secret ã‚’æŒãŸã›ã¾ã™ï¼
```rust
struct Client {
    api_key: String,
    api_secret_key: String,
    access_token: String,
    access_token_secret: String,
}
```
`impl Client` å†…ã«ä»¥ä¸‹ã®é–¢æ•°ã‚’ç”¨æ„ã—ã¾ã™ï¼š
- é–¢é€£é–¢æ•° `from_config()` ã‚’ä½¿ã£ã¦ config ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã—ã¾ã™ï¼
- `Client` ã«ï¼Œãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®é–¢æ•° `tweet()` ã‚’å®šç¾©ã—ã¾ã™ï¼ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹æ–‡å­—åˆ—ã‚’ `&str` ã§å—ã‘å–ã£ã¦ãƒ„ã‚¤ãƒ¼ãƒˆã—ï¼Œãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ï¼
- `tweet()` ã®ä¸­èº«ã¯ï¼Œ method ã¨ URL ã¨ã€Œãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’å—ã‘å–ã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹é–¢æ•° `request()` ã‚’å‘¼ã³å‡ºã™ã ã‘ã«ã—ã¾ã™ï¼
- `request()` ã¯ã€Œãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’ `&std::collections::BTreeMap<&str, &str>` ã¨ã—ã¦å—ã‘å–ã‚‹ã“ã¨ã«ã—ã¾ã™ï¼
- `request()` ã¯ method ï¼Œ URL ï¼Œã€Œãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’é–¢æ•° `authorization()` ã«æ¸¡ã—ï¼Œ `authorization()` ã¯ HTTP ã® Authorization ãƒ˜ãƒƒãƒ€ã®å†…å®¹ã‚’ `String` ã§è¿”ã—ã¾ã™ï¼ signature ã®ç”Ÿæˆã¯ `authorization()` å†…ã§è¡Œã†ãŸã‚ï¼Œ `request()` ã®å†…éƒ¨ã§ã€Œãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ï¼
- `request()` ã¯ HTTP ã®ä»–ã®è¦ç´ ã‚‚æƒãˆï¼Œ reqwest ã§é€ã‚Šã¾ã™ï¼
- `authorization()` ã®ä¸­ã§ï¼Œ timestamp ã‚„ nonce ã®ç”Ÿæˆã‚’è¡Œã„ï¼Œã€Œãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’ `Vec<(&str, &str)>` ã¨ã—ã¦æƒãˆã¾ã™ï¼
- `authorization()` ã¯ method ï¼Œ URL ï¼Œãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼Œãã®ä»–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¨ã¦é–¢æ•° `signature()` ã«æ¸¡ã—ï¼Œ `signature()` ã¯ signature ã‚’ `String` ã§è¿”ã—ã¾ã™ï¼ `signature()` ã®ä¸­ã§ API secret key ã¨ access token secret ã‚’ä½¿ç”¨ã—ã¾ã™ï¼
# å®Ÿè£…
ä»¥ä¸‹ï¼Œä¸€ã¤ä¸€ã¤ã®é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ï¼
## `from_config()`
æŒ‡å®šã•ã‚ŒãŸåå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãï¼Œ API key ï¼Œ API secret key ï¼Œ access token ï¼Œ access token secret ã®é †ã«ä¸€è¡Œãšã¤èª­ã¿è¾¼ã¿ã¾ã™ï¼
```rust
fn from_config(filename: &str) -> Result<Client, Box<dyn std::error::Error>> {
    let config = std::fs::File::open(filename)?;
    let mut reader = std::io::BufReader::new(config);
    fn read_line<T: std::io::BufRead>(
        reader: &mut T,
    ) -> Result<String, Box<dyn std::error::Error>> {
        let mut s = String::new();
        reader.read_line(&mut s)?;
	s.pop();
        Ok(s)
    }
    Ok(Client {
        api_key: read_line(&mut reader)?,
        api_secret_key: read_line(&mut reader)?,
        access_token: read_line(&mut reader)?,
        access_token_secret: read_line(&mut reader)?,
    })
}
```
## `tweet()`
`tweet()` ã‹ã‚‰ `request()` ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼
```rust
async fn tweet(&self, status: &str) -> Result<reqwest::Response, reqwest::Error> {
    let mut parameters = std::collections::BTreeMap::new();
    parameters.insert("status", status);
    self.request(
        reqwest::Method::POST,
        "https://api.twitter.com/1.1/statuses/update.json",
        &parameters,
    )
    .await
}
```
## `request()`
`request()` ã¯ reqwest ã‚’ä½¿ã£ã¦ HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Šã¾ã™ï¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½œã‚‹éš›ã« `authorization()` ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼
```rust
async fn request(
    &self,
    method: reqwest::Method,
    url: &str,
    parameters: &std::collections::BTreeMap<&str, &str>,
) -> Result<reqwest::Response, reqwest::Error> {
    let header_map = {
        use reqwest::header::*;
        let mut map = HeaderMap::new();
        map.insert(
            AUTHORIZATION,
            self.authorization(&method, url, parameters)
                .parse()
                .unwrap(),
        );
        map.insert(
            CONTENT_TYPE,
            HeaderValue::from_static("application/x-www-form-urlencoded"),
        );
        map
    };
    let url_with_parameters = format!(
        "{}?{}",
        url,
        equal_collect(parameters.iter().map(|(key, value)| { (*key, *value) })).join("&")
    );

    let client = reqwest::Client::new();
    client
        .request(method, &url_with_parameters)
        .headers(header_map)
        .send()
        .await
}
```
## `equal_collect()`
`request()` ã®ä¸­ã§ URL ã®æœ«å°¾ã«ãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¾ã™ãŒï¼Œã“ã®ã¨ãã«æ¬¡ã®ã‚ˆã†ãªé–¢æ•° `equal_collect()` ã‚’ä½¿ç”¨ã—ã¾ã™ï¼
```rust
fn equal_collect<'a, T: Iterator<Item = (&'a str, &'a str)>>(iter: T) -> Vec<String> {
    iter.map(|(key, value)| format!("{}={}", percent_encode(key), percent_encode(value)))
        .collect()
}
```
ã“ã‚Œã«ã‚ˆã£ã¦ï¼Œ `{"in_reply_to_status_id": "0000", "status": "hello"}` ã®ã‚ˆã†ãª `BTreeMap` ã‚’ `["in_reply_to_status_id=0000", "status=Hello"]` ã®ã‚ˆã†ãª `Vec` ã«å¤‰æ›ã§ãã¦ï¼Œã“ã‚Œã‚’ `join("&")` ã™ã‚‹ã“ã¨ã§ `"in_reply_to_status_id=0000&status=Hello"` ã®ã‚ˆã†ãªæ–‡å­—åˆ—ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼

`equal_collect()` ã¯ï¼Œ `authorization()` ã¨ `signature()` ã®ä¸­ã§ã‚‚ä½¿ç”¨ã—ã¾ã™ï¼
## `percent_encode()`
ã¾ãŸï¼Œ `equal_collect()` ã®ä¸­ã§ã¯æ¬¡ã®ã‚ˆã†ãªé–¢æ•° `percent_encode()` ã‚’ä½¿ç”¨ã—ã¾ã™ï¼
```rust
fn percent_encode(s: &str) -> percent_encoding::PercentEncode {
    use percent_encoding::*;
    const FRAGMENT: &AsciiSet = &NON_ALPHANUMERIC
        .remove(b'*')
        .remove(b'-')
        .remove(b'.')
        .remove(b'_');
    utf8_percent_encode(s, FRAGMENT)
}
```
`percent_encode()` ã¯ `signature()` ã®ä¸­ã§ã‚‚ä½¿ç”¨ã—ã¾ã™ï¼
## `authorization()`
`authorization()` ã§ã€Œãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚’ãã‚ãˆï¼Œ `signature()` ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ã€Œãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã« signature ã‚’è¿½åŠ ã—ï¼Œ Authorization ãƒ˜ãƒƒãƒ€ã‚’ç”Ÿæˆã—ã¾ã™ï¼
```rust
fn authorization(
    &self,
    method: &reqwest::Method,
    url: &str,
    parameters: &std::collections::BTreeMap<&str, &str>,
) -> String {
    let timestamp = format!("{}", chrono::Utc::now().timestamp());
    let nonce: String = {
        use rand::prelude::*;
        let mut rng = thread_rng();
        std::iter::repeat(())
            .map(|()| rng.sample(rand::distributions::Alphanumeric))
            .take(32)
            .collect()
    };

    let mut other_parameters: Vec<(&str, &str)> = vec![
        ("oauth_consumer_key", &self.api_key),
        ("oauth_token", &self.access_token),
        ("oauth_signature_method", "HMAC-SHA1"),
        ("oauth_version", "1.0"),
        ("oauth_timestamp", &timestamp),
        ("oauth_nonce", &nonce),
    ];

    let signature = self.signature(method, url, parameters.clone(), &other_parameters);

    other_parameters.push(("oauth_signature", &signature));

    format!(
        "OAuth {}",
        equal_collect(other_parameters.into_iter()).join(", ")
    )
}
```
## `signature()`
`signature()` ã¯ï¼Œ method ï¼Œ URL ï¼Œãƒ„ã‚¤ãƒ¼ãƒˆã®å†…å®¹ã«é–¢ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼Œãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å…¨ã¦ã‚ã‚ã›ã¦ï¼Œ API secret key ã¨ access token secret ã‚’ç”¨ã„ã¦ signature ã‚’ç”Ÿæˆã—ã¾ã™ï¼
```rust
fn signature<'a>(
    &self,
    method: &reqwest::Method,
    url: &str,
    mut parameters: std::collections::BTreeMap<&'a str, &'a str>,
    other_parameters: &Vec<(&'a str, &'a str)>,
) -> String {
    for (key, value) in other_parameters {
        parameters.insert(key, value);
    }
    let parameter_string = equal_collect(parameters.into_iter()).join("&");

    let signature_base_string = format!(
        "{}&{}&{}",
        method,
        percent_encode(url),
        percent_encode(&parameter_string)
    );
    let signing_key = format!("{}&{}", self.api_secret_key, self.access_token_secret);
    base64::encode(hmacsha1::hmac_sha1(
        signing_key.as_bytes(),
        signature_base_string.as_bytes(),
    ))
}
```
# ãƒ„ã‚¤ãƒ¼ãƒˆ
ã“ã‚Œã§ï¼Œ `main()` é–¢æ•°ã‹ã‚‰ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼
```rust
#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    match Client::from_config("config") {
        Ok(client) => {
            let response = client.tweet("hello").await?;
            let text = response.text().await?;
            println!("{}", text);
        }
        Err(err) => {
            println!("failed to read config file: {}", err);
        }
    }
    Ok(())
}
```
# ã¾ã¨ã‚
å…¨ä½“ã®ã‚³ãƒ¼ãƒ‰ã¯[ã“ã¡ã‚‰](https://github.com/fiveseven-lambda/twitter/tree/main/twitter)ã§ã™ï¼

ã“ã®è¨˜äº‹ã§ã¯ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã ã‘ã‚’ç›®æ¨™ã¨ã—ã¾ã—ãŸãŒï¼Œå®Ÿã¯ä¸Šã§å‡ºã¦ããŸ `Client::request()` é–¢æ•°ã«æ¸¡ã™ã‚‚ã®ã‚’å¤‰ãˆã‚‹ã ã‘ã§ï¼Œè¿”ä¿¡ã—ãŸã‚Š TL ã‚’èª­ã¿è¾¼ã‚“ã ã‚Šã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼

ç§ã¯ Rust ã‚’æ›¸ãå§‹ã‚ã¦ã‹ã‚‰ã¾ã æ—¥ãŒæµ…ã„ã®ã§ï¼Œè‰¯ããªã„æ›¸ãæ–¹ã‚’ã—ã¦ã„ã‚‹ç®‡æ‰€ãªã©ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ï¼ã‚‚ã—æ°—ä»˜ã„ãŸã“ã¨ãŒã‚ã‚Œã°æŒ‡æ‘˜ã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ï¼
